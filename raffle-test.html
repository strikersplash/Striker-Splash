<!DOCTYPE html>
<html>
  <head>
    <title>Raffle Test Page</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container mt-4">
      <h2>Raffle Test</h2>
      <button id="test-draw" class="btn btn-primary">
        <i class="bi bi-shuffle me-1"></i> Test Draw
      </button>
      <div id="result" class="mt-3"></div>
    </div>

    <script>
      document
        .getElementById("test-draw")
        .addEventListener("click", function () {
          console.log("Test button clicked");

          this.disabled = true;
          this.innerHTML =
            '<span class="spinner-border spinner-border-sm me-1"></span> Testing...';

          fetch("/admin/raffle/draw", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              date: "2025-07-19",
            }),
          })
            .then((response) => {
              console.log("Response status:", response.status);
              return response.json();
            })
            .then((data) => {
              console.log("Response data:", data);
              document.getElementById("result").innerHTML =
                '<div class="alert alert-info">Response: ' +
                JSON.stringify(data, null, 2) +
                "</div>";

              this.disabled = false;
              this.innerHTML = '<i class="bi bi-shuffle me-1"></i> Test Draw';
            })
            .catch((error) => {
              console.error("Error:", error);
              document.getElementById("result").innerHTML =
                '<div class="alert alert-danger">Error: ' +
                error.message +
                "</div>";

              this.disabled = false;
              this.innerHTML = '<i class="bi bi-shuffle me-1"></i> Test Draw';
            });
        });
    </script>
  </body>
</html>
