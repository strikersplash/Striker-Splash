<div class="container-fluid mt-3 staff-dashboard">
  <div class="row">
    <div class="col-12">
      <div class="card mb-4">
        <div class="card-header bg-primary text-white">
          <h3 class="mb-0">Staff Dashboard</h3>
        </div>
        <div class="card-body">
          <!-- Low Ticket Warning -->
          <% if (ticketInfo && ticketInfo.lowTicketWarning) { %>
          <div
            class="alert alert-warning alert-dismissible fade show mb-4"
            role="alert"
          >
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <strong>Low Ticket Warning!</strong>
            Only <strong><%= ticketInfo.availableTickets %></strong> tickets
            remaining in the current roll (<%= ticketInfo.ticketRange %>).
            Please notify an administrator to update the ticket range.
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>
          <% } %>

          <div class="row">
            <div class="col-lg-4 col-md-6 mb-4">
              <div class="card h-100">
                <div class="card-body text-center">
                  <i
                    class="bi bi-cash-coin"
                    style="font-size: 2.5rem; color: #28a745"
                  ></i>
                  <h5 class="mt-3">Cashier Interface</h5>
                  <p class="small">
                    Sell kicks, manage queue tickets, and process payments
                  </p>
                  <a href="/cashier" class="btn btn-success w-100"
                    >Go to Cashier</a
                  >
                </div>
              </div>
            </div>

            <div class="col-lg-4 col-md-6 mb-4">
              <div class="card h-100">
                <div class="card-body text-center">
                  <i
                    class="bi bi-flag"
                    style="font-size: 2.5rem; color: #007bff"
                  ></i>
                  <h4 class="mt-3">Referee Interface</h4>
                  <p>Log goals, manage players, and track competition</p>
                  <a href="/referee" class="btn btn-primary">Go to Referee</a>
                </div>
              </div>
            </div>

            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body text-center">
                  <i
                    class="bi bi-trophy"
                    style="font-size: 3rem; color: #ffc107"
                  ></i>
                  <h4 class="mt-3">Competition Setup</h4>
                  <p>
                    Create and manage competitions, set up 1v1 or team matches,
                    and track participants
                  </p>
                  <a href="/staff/competition-setup" class="btn btn-warning"
                    >Setup Competitions</a
                  >
                </div>
              </div>
            </div>

            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body text-center">
                  <i
                    class="bi bi-calendar-event"
                    style="font-size: 3rem; color: #fd7e14"
                  ></i>
                  <h4 class="mt-3">Event Registration Management</h4>
                  <p>
                    Assign queue tickets to players who registered for events in
                    advance
                  </p>
                  <a
                    href="/staff/event-registration-management"
                    class="btn btn-warning"
                    >Manage Registrations</a
                  >
                </div>
              </div>
            </div>

            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body text-center">
                  <i
                    class="bi bi-pencil-square"
                    style="font-size: 3rem; color: #6c757d"
                  ></i>
                  <h4 class="mt-3">Edit User Profile</h4>
                  <p>
                    Update player information including names, contact details,
                    and more
                  </p>
                  <a href="/staff/name-change" class="btn btn-secondary"
                    >Edit Profiles</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Queue Status -->
      <div class="card mb-4">
        <div class="card-header bg-info text-white">
          <h5 class="mb-0">Current Queue Status</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <div class="alert alert-info">
                <h5>Now Serving</h5>
                <h2 id="current-queue-number">
                  <%= currentQueuePosition || 'No active tickets' %>
                </h2>
              </div>
            </div>
            <div class="col-md-6">
              <div class="alert alert-warning">
                <h5>Next Ticket</h5>
                <h2 id="next-ticket-number"><%= nextTicket %></h2>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Auto-refresh queue status every 10 seconds
  setInterval(function () {
    fetch("/api/queue/current")
      .then((response) => response.json())
      .then((data) => {
        const currentEl = document.getElementById("current-queue-number");
        const nextEl = document.getElementById("next-ticket-number");
        if (data.currentQueuePosition) {
          currentEl.textContent = data.currentQueuePosition;
        } else {
          currentEl.textContent = "No active tickets";
        }
        if (typeof data.nextTicket === "number" && !isNaN(data.nextTicket)) {
          nextEl.textContent = data.nextTicket;
        }
      })
      .catch((error) => console.error("Error updating queue position:", error));
  }, 10000);
</script>
